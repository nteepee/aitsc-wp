# ESP32 Memory-Optimized Build Configuration
# Add these settings to your platformio.ini or Arduino IDE build settings

[env:esp32dev_optimized]
platform = espressif32
board = esp32dev
framework = arduino

# Critical compiler optimization flags to save program memory
build_flags =
    -Os                         # Optimize for size (most important)
    -ffunction-sections         # Put functions in separate sections
    -fdata-sections            # Put data in separate sections
    -Wl,--gc-sections          # Enable garbage collection of unused sections
    -DCORE_DEBUG_LEVEL=0       # Disable all debug output
    -DDISABLE_ALL_LIBRARY_WARNINGS  # Remove library warnings
    -fno-exceptions            # Disable C++ exceptions
    -fno-rtti                  # Disable C++ RTTI
    -DLVGL_OPTIMIZE_SIZE       # LVGL size optimization
    -DARDUINO_USB_CDC_ON_BOOT=0  # Disable USB CDC

# Memory configuration
build_unflags =
    -O2                        # Remove default O2 optimization
    -Os                        # Remove default Os if present

# Partition table for more app space (optional)
board_build.partitions = huge_app.csv

# Reduce build verbosity
monitor_speed = 115200
upload_speed = 921600

# Additional ESP32-specific optimizations
board_build.flash_mode = dio
board_build.f_flash = 80000000L
board_build.f_cpu = 240000000L